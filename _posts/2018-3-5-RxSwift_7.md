---
layout:     post
title:      "RxSwift. ê¸°ì´ˆ ì •ë¦¬í•˜ê¸° (7)"
subtitle:   "Time based Operators, Buffering operators, Windows of buffed observables, Time-shifting operators, Timer operators, Timeout"
date:       2018-03-05 17:13:00
author:     "MinJun"
header-img: "img/tags/Swift-bg.jpg"
comments: true 
tags: [RxSwift]
---


Raywenderlich-Ebookì˜ RxSwiftë¥¼ ì½ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.

---

## RxSwift ì •ë¦¬ (7) 

- Time based Operators 
- Buffering operators
	- Replaying past elements
	- Unlimited replay
	- Controlled buffering
- Windows of buffed observables 
- Time-shifting operators
	- Delayed subscriptions
	- Delayed elements
- Timer operators
	- Intervals 
	- One-shot or repeating timers
	- Timeout 
- Circumscribe side effects(ë¶€ìˆ˜ì‘ìš© ì–µì œí•˜ê¸°-ì°¸ê³ ìë£Œ)
- Reference 

---

## Time Based Operators  

Reactive programmingì˜ í•µì‹¬ ì•„ì´ë””ì–´ëŠ” ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ë¹„ë™ê¸° ë°ì´í„° íë¦„ì„ ëª¨ë¸ë§ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. RxSwiftëŠ” ì‹œê°„ê³¼ ì‹œí€€ìŠ¤ê°€ ë°˜ì‘í•˜ê³ , ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ë³€í˜•ë˜ëŠ” ë°©ì‹ì„ ì²˜ë¦¬í• ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì—°ì‚°ìë¥¼ ì œê³µí•©ë‹ˆë‹¤.

sequenceì˜ ì‹œê°„ì„ ê´€ë¦¬í•˜ëŠ” ì „ëµì„ ì‰½ìŠµë‹ˆë‹¤. time-based operatorsë¥¼ ì—°ìŠµí•˜ë ¤ë©´ ë°ì´í„°ì˜ íë¦„ì„ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” animationì„ ì´ìš©í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤. 

---

### Buffering operators 

- Buffering ì—°ì‚°ìë“¤ì€ ê³¼ê±°ì˜ ìš”ì†Œë“¤ì„ ìƒˆë¡œìš´ êµ¬ë…ìì—ê²Œ ë‹¤ì‹œ ì¬ìƒí•˜ê±°ë‚˜, ì ì‹œ ë²„í¼ë¥¼ ë‘ê³  ì¤„ìˆ˜ ì‡ì”ë‹ˆë‹¤. ì–¸ì œ, ì–´ë–»ê²Œ ê³¼ê±°ì™€ ë¯¸ë˜ì— ìƒˆë¡œìš´ ìš”ì†Œë“¤ì„ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì„ ì»¨íŠ¸ë¡¤í•˜ëŠ”ì§€ ë°°ì›Œë´…ë‹ˆë‹¤. 

---

#### - Replaying past elements 

seqeunceê°€ ì•„ì´í…œë“¤ì„ ë°©ì¶œí• ë•Œ ê³¼ê±°ì˜ ì•„ì´í…œì„ êµ¬ë…ìê°€ ë°›ëŠ”ì§€ í™•ì‹ í•´ì•¼í•  í•„ìš”ê°€ ìˆì„ë•Œê°€ ìˆë‹¤. ê·¸ê²ƒì€ `replay(_:)`, `replayAll()` operatorsì˜ ëª©ì ì…ë‹ˆë‹¤. 

ë˜í•œ ë°©ì¶œëœ ì´ ìš”ì†Œ ìˆ˜ë¥¼ ì œí•œí•˜ê³  ìƒˆë¡œìš´ êµ¬ë…ìì—ê²Œ `played back` ìš”ì†Œ ìˆ˜ë¥¼ ì œì–´í•©ë‹ˆë‹¤. Observable<T>.createí•¨ìˆ˜ì™€ dispatch magicì„ ì‚¬ìš©í•˜ì—¬ ë°©ì¶œì„ ê´€ì°°í• ìˆ˜ ìˆê²Œ ë§Œë“­ë‹ˆë‹¤(?)

DispatchSource.timerëŠ” Playgroundì— ì •ì˜ëœ extension ì…ë‹ˆë‹¤. ê·¸ê²ƒì€ ë°˜ë³µ íƒ€ì´ë¨¸ì˜ ìƒì„±ì„ ë‹¨ìˆœí™”ì‹œí‚µë‹ˆë‹¤. ìš”ì†Œë¥¼ ë°©ì¶œí•˜ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•˜ì„¸ìš”.

`.replay`ëŠ” Source Observableë¡œ ë¶€í„° ë°©ì¶œëœ ë§ˆì§€ë§‰ replayedElementsë¥¼ ê¸°ë¡í•˜ëŠ” ìƒˆë¡œìš´ sequenceë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 


```swift
class TimelineView<E>: TimelineViewBase, ObserverType where E: CustomStringConvertible {
    static func make() -> TimelineView<E> {
        return TimelineView(width: 400, height: 100)
    }
    public func on(_ event: Event<E>) {
        switch event {
        case .next(let value):
            add(.Next(String(describing: value)))
        case .completed:
            add(.Completed())
        case .error(_):
            add(.Error())
        }
    }
}

let elementsPerSecond = 1
let maxElements = 5
let replayedElements = 1
let replayDelay: TimeInterval = 3
let sourceObservable = Observable<Int>
    .interval(RxTimeInterval(1.0 / Double(elementsPerSecond)), scheduler: MainScheduler.instance)
    .replay(replayedElements)
let sourceTimeline = TimelineView<Int>.make()
let replayedTimeline = TimelineView<Int>.make()

let stack = UIStackView.makeVertical([
    UILabel.makeTitle("replay"),
    UILabel.make("Emit \(elementsPerSecond) per second:"),
    sourceTimeline,
    UILabel.make("Replay \(replayedElements) after \(replayDelay) sec:"),
    replayedTimeline])

_ = sourceObservable.subscribe(sourceTimeline)
DispatchQueue.main.asyncAfter(deadline: .now() + replayDelay) {
    _ = sourceObservable.subscribe(replayedTimeline)
}

_ = sourceObservable.connect()

let hostView = setupHostView()
hostView.addSubview(stack)
hostView
```

ìƒˆë¡œìš´ Observerê°€ êµ¬ë…í• ë•Œë§ˆë‹¤, ë²„í¼ë§ ëœ ìš”ì†Œ(ìˆëŠ”ê²½ìš°)ë¥¼ ì¦‰ì‹œ ìˆ˜ì‹ í•˜ê³  ì¼ë°˜ êµ¬ë…ê³¼ ê°™ì´ ìƒˆë¡œìš´ ìš”ì†Œë¥¼ ê³„ì† ìˆ˜ì‹ í•©ë‹ˆë‹¤.

replay(:)ì˜ ì‹¤ì œ íš¨ê³¼ë¥¼ ì‹œê°í™” í•˜ê¸° ìœ„í•´, í•œìŒì˜ TimeLineViewë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 

TimeLineView í´ë ˆìŠ¤ëŠ” Playground ì•„ë˜ìª½ Source ê·¸ë£¹ì˜ TimeLineViewBase í´ë ˆìŠ¤ì— ì •ì˜ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ í´ë˜ìŠ¤ëŠ” observableì˜ ì´ë²¤íŠ¸ ë°©ì¶œì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì‹œê°í™” í•´ì¤ë‹ˆë‹¤.

`replay(_:)`ê°€ connectable observableì„ ìƒì„±í•˜ê¸° ëŒ€ë¬¸ì— ì•„ì´í…œì„ ë°›ê¸° ì‹œì‘í•˜ë ¤ë©´ ê¸°ë³¸ ì†ŒìŠ¤ì— ì—°ê²°í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì„ í•˜ì§€ ì•Šìœ¼ë©´ êµ¬ë…ìëŠ” ì•„ë¬´ ê°’ë„ë°›ì§€ ëª»í•©ë‹ˆë‹¤.  `connect()` í•©ë‹ˆë‹¤.



> note `ConnectableObservable`ì€ Observableê³„ì—´ì˜ íŠ¹ë³„í•œ í´ë˜ìŠ¤ ì…ë‹ˆë‹¤. ì´ë“¤ì€ `connect()` ë©”ì†Œë“œë¥¼ í†µí•´ ë¶ˆë¦¬ê¸° ì „ê¹Œì§€ëŠ” êµ¬ë…ì ìˆ˜ì™€ ê´€ê³„ ì—†ì´, ì•„ë¬´ê°’ë„ ë°©ì¶œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¼ë¶€ ì—°ì‚°ìëŠ” Observable<E>ê°€ ì•„ë‹Œ ConnectableObservable<E>ë¥¼ ë°˜í•œí•©ë‹ˆë‹¤. 
> 
> ì´ ì—°ì‚°ìëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. `replay(_:), replayAll(), multicast(_:), publish()`
> 
> ì´ë“¤ì€ observableì˜ ìˆ˜ì— ê´€ê³„ì—†ì´ ê´€ì°° ëŒ€ìƒì— ëŒ€í•œ ë‹¨ì¼ êµ¬ë…ì„ ê³µìœ í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.  <br>


<center><img src="/img/posts/Time-based.png" width="500" height="300"></center> <br> 

ì‚¬ìš©í•œ ì„¤ì •ì—ì„œëŠ” replayedElementsëŠ” 1ì…ë‹ˆë‹¤. replay(_:) ì—°ì‚°ìê°€ source observableì—ì„œ ë§ˆì§€ë§‰ìœ¼ë¡œ ë°©ì¶œí•˜ëŠ” ê°’ë§Œì„ ë²„í¼ë¡œ ë‘ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤

íƒ€ì„ë¼ì¸ì„ ë³´ë©´, ë‘ë²ˆì§¸ êµ¬ë…ìê°€ 3, 4 ìš”ì†Œë“¤ì„ ë™ì‹œì— ë°›ì€ ê²ƒì„ ë³¼ìˆ˜ ìˆìŠµë‹ˆë‹¤. êµ¬ë…í•˜ëŠ” ì‹œê°„ì— ë”°ë¼, ë§ˆì§€ë§‰ ë²„í¼ê°’ì¸ 3ê³¼, ë‘ë²ˆì§¸ êµ¬ë…ì„ í•¨ìœ¼ë¡œì¨ ë°›ì€ 4ë¥¼ ë™ì‹œì— ë°›ì€ ê²ƒì…ë‹ˆë‹¤. (ì‚¬ì‹¤ ì •í™•íˆ ê°™ì€ ìˆœê°„ì€ ì•„ë‹™ë‹ˆë‹¤.)
`replayDelay`ì™€ `replayedElements` ê°’ì„ ë³€ê²½í•´ê°€ë©´ì„œ í”Œë ˆì´í•´ë³´ì.

---

#### - Unlimited replay 

ë‘ë²ˆì§¸ë¡œ ì‚¬ìš©í• ìˆ˜ ìˆëŠ” ì¬ìƒ ì—°ì‚°ìëŠ” replayAll() ì…ë‹ˆë‹¤. ì´ ì˜µì…˜ì€ ì£¼ì˜í•´ì„œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ë²„í¼ë§ëœ ìš”ì†Œì˜ ì´ ìˆ˜ë¥¼ í•©ë¦¬ì ìœ¼ë¡œ ìœ ì§€í•´ì•¼ í•˜ëŠ” ê²½ìš°ì—ë§Œ ì‚¬ìš©í•˜ì„¸ìš”. 

ì˜ˆë¥¼ë“¤ì–´ HTTP reqeustsì˜ contextì¼ë•Œ replayAll()ì„ ì‚¬ìš©í•˜ì„¸ìš”. ì¿¼ë¦¬ì—ì„œ ë°˜í™˜í•˜ëŠ” ë°ì´í„°ë¥¼ ìœ ì§€í•˜ëŠ”ê²½ìš° ë©”ëª¨ë¦¬ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì•Œìˆ˜ ìˆìŠµë‹ˆë‹¤. 

ë°˜ë©´ì—, replayAll()ì„ ì‚¬ìš©í•˜ì—¬ ì¢…ë£Œí•˜ì§€ ì•Šê³  ë§ì€ ì–‘ì˜ ë°ì´í„°ë¥¼ ìƒì„±í• ìˆ˜ ìˆëŠ” seqeuenceì—ì„œ ì‚¬ìš©í•˜ë©´ ë©”ëª¨ë¦¬ê°€ ë¶€í•˜ê°€ ìƒê¸°ê²Œë©ë‹ˆë‹¤. 

ìœ„ì˜ replayì˜ ì˜ˆì œ ì½”ë“œì¤‘ `.replay(replayedElements)` ë¥¼ `reaplyAll()`ë¡œ ë¶€ê¾¸ì–´ ë³´ì

ë‘ë²ˆì§¸ êµ¬ë… ì¦‰ì‹œ ëª¨ë“  ë²„í¼ ìš”ì†Œë“¤ì´ ë‚˜íƒ€ë‚˜ëŠ”ê²ƒì„ í™•ì¸ í• ìˆ˜ ìˆë‹¤.

---

#### - Controlled buffering 

`buffer(timeSpan:cout:scheduler:)` ì—°ì‚°ìì— ëŒ€í•´ ë¨¼ì € ì•Œì•„ë´…ì‹œë‹¤. 

```swift
let bufferTimeSpan:RxTimeInterval = 4
let bufferMaxCount = 2
 
let sourceObservable = PublishSubject<String>()

let sourceTimeline = TimelineView<String>.make()
let bufferedTimeline = TimelineView<Int>.make()
 
let stack = UIStackView.makeVertical([
     UILabel.makeTitle("buffer"),
     UILabel.make("Emitted elements:"),
     sourceTimeline,
     UILabel.make("Buffered elements (at most \(bufferMaxCount) every \(bufferTimeSpan) seconds:"),
     bufferedTimeline])
 

_ = sourceObservable.subscribe(sourceTimeline)
 

sourceObservable
     .buffer(timeSpan: bufferTimeSpan, count: bufferMaxCount, scheduler: MainScheduler.instance)
     .map { $0.count }
     .subscribe(bufferedTimeline)
 

let hostView = setupHostView()
hostView.addSubview(stack)
hostView
 

DispatchQueue.main.asyncAfter(deadline: .now() + 5) {
     sourceObservable.onNext("ğŸ±")
     sourceObservable.onNext("ğŸ±")
     sourceObservable.onNext("ğŸ±")
}
```

ìœ„ì˜ `replay`ì˜ˆì œì™€ ë¹„ìŠ·í•©ë‹ˆë‹¤. ìœ„ì˜ ì½”ë“œëŠ” `buffer`ì—°ì‚°ìë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•œ í–‰ë™ë“¤ì„ ì •ì˜ í•©ë‹ˆë‹¤. ì§§ì€ ì´ëª¨ì§€ë¥¼ ì…ë ¥í•˜ê¸° ìœ„í•´ `PublishSubject`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. 

ë²„í¼ëœ íƒ€ì…ì€ ê°ê° ë²„í¼ì–´ë ˆì´ì— ìˆëŠ” ìš”ì†Œë“¤ì˜ ê°œìˆ˜ë¥¼ ë³´ì—¬ì¤„ê²ƒì…ë‹ˆë‹¤. 

Source Observableì˜ Arrayì— ìˆëŠ” ìš”ì†Œë“¤ì„ ë°›ê¸°ë¥¼ ì›í•©ë‹ˆë‹¤. ê°ê°ì˜ arrayë“¤ì€ bufferMaxCount ë§Œí¼ì˜ ìš”ì†Œë¥¼ ê°€ì§ˆìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë§ì€ ìš”ì†Œë“¤ì´ bufferTimeSpanì´ ë§Œë£Œë˜ê¸° ì „ì— ë°›ì•„ ì¡Œë‹¤ë©´, ì—°ì‚°ìëŠ” ë²„í¼ ìš”ì†Œë“¤ì„ ë°©ì¶œí•˜ê³  íƒ€ì´ë¨¸ë¥¼ ì´ˆê¸°í™” í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ ê·¸ë£¹ ë°©ì¶œ ì´í›„ bufferTimespanì˜ ì§€ì—°ì—ì„œ `buffer`ëŠ” í•˜ë‚˜ì˜ arrayë¥¼ ë°©ì¶œí• ê²ƒ ì…ë‹ˆë‹¤. ë§Œì•½ ì§€ì—°ì‹œê°„ë™ì•ˆ ë°›ì€ ìš”ì†Œê°€ ì—†ë‹¤ë©´ arrayëŠ” ë¹ˆê°’ì´ ë©ë‹ˆë‹¤. 

Source Observableì— ì•„ë¬´ëŸ° í™œë™ì´ ì—†ì–´ë„, ë²„í¼ íƒ€ì„ë¼ì¸ì— ë¹ˆ ë²„í¼ê°€ ìˆë‹¤ëŠ”ê²ƒì„ í™•ì‹  í• ìˆ˜ ìˆìŠµë‹ˆë‹¤. `buffer(_:scheduler:)` ì—°ì‚°ìëŠ” source observableì—ì„œ ë°›ì„ ê²ƒì´ ì—†ìœ¼ë©´ ì¼ì • ê°„ê²©ìœ¼ë¡œ ë¹„ì–´ìˆëŠ” Arrayë¥¼ ë°©ì¶œí•©ë‹ˆë‹¤. 0ì€ source observableì—ì„œ 0ê°œì˜ ìš”ì†Œê°€ ë°©ì¶œë˜ì—ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì´ì œ source observableì— ë°ì´í„°ë¥¼ ê³µê¸‰í• ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë²„í¼ë§ëœ observableì— ì–´ë–¤ ì˜í–¥ì´ ë‚˜íƒ€ë‚˜ëŠ”ì§€ í™•ì¸í•´ë´…ë‹ˆë‹¤. ë¨¼ì € 5ì´ˆë™ì•ˆ 3ê°œì˜ ìš”ì†Œë¥¼ ì§‘ì–´ ë„£ì–´ ë´…ë‹ˆë‹¤. <br>

<center><img src="/img/posts/Time-based-1.png" width="500" height="300"></center> <br> 

ê° ìƒìì—ëŠ” ë°©ì¶œëœ ê° ë°°ì—´ì˜ ìš”ì†Œ ìˆ˜ê°€ í‘œì‹œë©ë‹ˆë‹¤. 

- ì²˜ìŒì—ëŠ” ë²„í¼ë§ëœ íƒ€ì„ë¼ì¸ì´ ë¹ˆ ë°°ì—´ì„ í‘œì‹œí•©ë‹ˆë‹¤
- ê·¸ëŸ¬ë©´ ê´€ì°° í• ìˆ˜ ìˆëŠ” ì†ŒìŠ¤ì˜ ì„¸ ìš”ì†Œë¥¼ í‘¸ì‹œí•©ë‹ˆë‹¤
- ë²„í¼ë§ëœ íƒ€ì„ ë¼ì¸ì€ ë‘ìš”ì†Œì˜ ë°°ì—´ì„ ì§ì‹œ ê°€ì ¸ì˜µë‹ˆë‹¤. ì§€ì •í•œ ìµœëŒ€ê³„ìˆ˜(bufferMacCount ìƒìˆ˜ë¡œ ì¸í•´ì„œ)
- 4ì´ˆê°€ ì§€ë‚˜ë©´ í•˜ë‚˜ì˜ ìš”ì†Œë§Œ ìˆëŠ” ë°°ì—´ì´ ë°©ì¶œë©ë‹ˆë‹¤. sourceì— í‘¸ì‹œëœ ì„¸ ê°€ì§€ ìš”ì†Œì¤‘ ë§ˆì§€ë§‰ 

ë³´ë‹¤ì‹œí”¼, ë²„í¼ëŠ” ì „ì²´ ìš©ëŸ‰ì— ë„ë‹¬í•˜ë©´ ì¦‰ì‹œ ìš”ì†Œ ë°°ì—´ì„ ë°©ì¶œí•œë‹¤ìŒ, ì§€ì •ëœ ë°°ì—´ì„ ê¸°ë‹¤ë¦¬ê±°ë‚˜ ë‹¤ì‹œ ì±„ì›Œì„œ ìƒˆ ë°°ì—´ì„ ë°©ì¶œí•©ë‹ˆë‹¤. ë‹¤ë¥¸ ë²„í¼ë§ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë” ë§ì€ ì¬ìƒì„ í• ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš”ì†Œë¥¼ ë‚´ë³´ë‚´ëŠ” DispatchQueueë¥¼ ì œê±°í•˜ê³  ë‹¤ìŒì„ ì¶”ê°€í•©ë‹ˆë‹¤.  <br>

1/0.7 ê°„ê²©ìœ¼ë¡œ sourceObservleì— ğŸ±ì„ í‘¸ì‹œí•©ë‹ˆë‹¤. <br>

```swift
let elementsPerSecond = 0.7
let timer = DispatchSource.timer(interval: 1.0 /
Double(elementsPerSecond), queue: .main) {

   sourceObservable.onNext("ğŸ±")
}
```

---

### Windows of buffed observables 


bufferingì˜ ë§ˆì§€ë§‰ì€ `window(timeSpan:count:scheduler:)` ì…ë‹ˆë‹¤. `buffer(timeSpan:count:scheduler:)`ê³¼ ë¹„ìŠ·í•˜ê²Œ ì‘ë™í•˜ì§€ë§Œ ìœ ì¼í•œ ì°¨ì´ì ì€ Arrayë¥¼ ë°©ì¶œí•˜ëŠ” ëŒ€ì‹  bufferingëœ Observableì„ ë°©ì¶œí•œë‹¤ëŠ” ê²ƒ ì…ë‹ˆë‹¤. 

`window`ì˜ sequenceëŠ” ì—¬ëŸ¬ Observableì„ ë°©ì¶œí•˜ë¯€ë¡œ, ê°œë³„ì ìœ¼ë¡œ ì‹œê°í™” í•˜ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤.

```swift
let elementsPerSecond = 3
let windowTimeSpan: RxTimeInterval = 4
let windowMaxCount = 10
let sourceObservable = PublishSubject<String>()

let sourceTimeline = TimelineView<String>.make()
let stack = UIStackView.makeVertical([
    UILabel.makeTitle("window"),
    UILabel.make("Emitted elements (\(elementsPerSecond) per sec.):"),
    sourceTimeline,
    UILabel.make("Windowed observables (at most \(windowMaxCount) every \(windowTimeSpan) sec):")])

let timer = DispatchSource.timer(interval: 1.0 /
    Double(elementsPerSecond), queue: .main) { sourceObservable.onNext("ğŸ˜¡") }
_ = sourceObservable.subscribe(sourceTimeline)

_ = sourceObservable
    .window(timeSpan: windowTimeSpan, count: windowMaxCount, scheduler:
        MainScheduler.instance)
    .flatMap { windowedObservable -> Observable<(TimelineView<Int>, String?)> in
        let timeline = TimelineView<Int>.make()
        stack.insert(timeline, at: 4)
        stack.keep(atMost: 8)
        return windowedObservable
            .map { value in (timeline, value) }
            .concat(Observable.just((timeline, nil)))
}
    .subscribe(onNext: { tuple in
        let (timeline, value) = tuple
        if let value = value {
            timeline.add(.Next(value))
        } else {
            timeline.add(.Completed(true))
        }
    })
let hostView = setupHostView()
hostView.addSubview(stack)
hostView
```

Stringì„ PublishSubjectë¡œ í‘¸ì‹œí•˜ì—¬ ì¶œë ¥ëœ observableí•­ëª©ì—ì„œ ì‹œê°„ë³„ë¡œ ì¶”ë ¥ì„ ê·¸ë£¹í™” í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ìš”ì†Œë“¤ì„ source observableì— í‘¸ì‹œí•˜ê¸° ìœ„í•œ íƒ€ì´ë¨¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. 

source timelineì„ ì±„ì›ë‹ˆë‹¤. ê°ê° ë°©ì¶œëœ observableì´ ë¶„ë¦¬ë˜ì–´ ë³¼ìˆ˜ ìˆê²Œí•©ë‹ˆë‹¤. ë§¤ë²ˆ `window(timeSpan:count:scheduler:)`ê°€ ìƒˆë¡œìš´ observableì„ ë°©ì¶œí•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ íƒ€ì„ë¼ì¸ì„ ì‚½ì…í•©ë‹ˆë‹¤. ì´ì „ observableë“¤ì€ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ì•¼ í•©ë‹ˆë‹¤. window observableì€ ì–´ë–»ê²Œ ë°©ì¶œë  observableì„ ê´€ë¦¬í• ìˆ˜ ìˆìŠµë‹ˆê¹Œ? 

ë‚´ë¶€ì˜ observableë“¤ì„ `timeline`ì™€ `value`ë¥¼ ì¡°í•©í•œ íŠœí”Œë¡œ ë§¤í•‘í•©ë‹ˆë‹¤. ì´ ëª©ì ì€ ë‘ ê°’ì„ í‘œì‹œí• ìˆ˜ ìˆëŠ” ê³³ìœ¼ë¡œ ê°™ì´ ì˜®ê¸°ë ¤ëŠ”ê²ƒ ì…ë‹ˆë‹¤. 

ë‚´ë¶€ì˜ observableì´ ì™„ë£Œë˜ë©´ `concat(_:)`ìœ¼ë¡œ í•˜ë‚˜ì˜ íŠœí”Œì„ ì—°ê²° í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ íƒ€ì„ ë¼ì¸ì´ ì™„ë£Œë˜ì—ˆìŒì„ í‘œì‹œí• ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

`flatMap(_:)`ìœ¼ë¡œ ê²°ê³¼ê°’(observableì˜ observable)ì„ í•˜ë‚˜ì˜ tuple sequenceë¡œ ë³€í™˜ í• ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

ì—¬ê¸°ì„œ tupleì† valueëŠ” `String?`íƒ€ì… ì…ë‹ˆë‹¤. ê°’ì´ `nil`ì´ë©´, sequenceê°€ ì¢…ë£Œë˜ì—ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. <br>

<center><img src="/img/posts/Time-based-2.png" width="500" height="300"></center> <br> 

ë§¨ ì•„ë˜ì—ì„œ ë‘ë²ˆì§¸ íƒ€ì„ ë¼ì¸ë¶€í„° ì‚´í´ë³´ë©´ ëª¨ë“  íƒ€ì„ë¼ì¸ì€ `ê°€ì¥ ìµœê·¼ê°’` ì…ë‹ˆë‹¤. windowed observableë‹¹ ìµœëŒ€ 5ê°œ ìš”ì†Œë¥¼ 4ì´ˆë§ˆë‹¤ `window`ë˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤. ì´ ê²ƒì€ ìƒˆë¡œìš´ observableì´ ì ì–´ë„ 4ì´ˆë§ˆë‹¤ ìƒì„±ë˜ê³  5ê°œì˜ ìš”ì†Œë¥¼ ëª¨ì€ ìˆœê°„ì— ë°©ì¶œë©ë‹ˆë‹¤. 

---

### Time-shifting operators 

RxSwiftëŠ” ê³¼ê±°ì˜ ì‹¤ìˆ˜ë¥¼ ìˆ˜ì •í•˜ëŠ”ë° ë„ì›€ì´ ë˜ì§€ ì•Šì§€ë§Œ ì ì‹œë™ì•ˆ ì‹œê°„ì„ ê³ ì •ì‹œì¼œ ìê¸° ë³µì œê°€ ê°€ëŠ¥í• ë•Œê¹Œì§€ ê¸°ë‹¤ë¦´ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë‘ê°œì˜ ì‹œê°„ê´€ë ¨ ì—°ì‚°ìë¥¼ ì‚´í´ ë³´ê² ìŠµë‹ˆë‹¤. 


---

#### - Delayed subscriptions 

`delaySubscription(_:scheduler:)`ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ì‹œë‹¤. ì§€ê¸ˆê¹Œì§€ íƒ€ì„ë¼ì¸ ì• ë‹ˆë©”ì´ì…˜ ë§Œë“œëŠ”ê²ƒì„ ë§ì´ í•´ë´¤ìœ¼ë‹ˆê¹Œ, ì´ë²ˆì—ëŠ” ê°„ë‹¨íˆ `delaySubscription`ì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ë§Œ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤. 

```swift
_ = sourceObservable
  .delaySubscription(RxTimeInterval(delayInSeconds), scheduler:
MainScheduler.instance)
  .subscribe(delayedTimeline)
```

<center><img src="/img/posts/Time-based-3.png" width="500" height="300"></center> <br> 

ì´ë¦„ì—ì„œ ìœ ì¶”í• ìˆ˜ ìˆë“¯ì´, êµ¬ë…ì„ ì‹œì‘í›„ ìš”ì†Œë¥¼ ë°›ê¸° ì‹œì‘í•˜ëŠ” ì‹œì ì„ ì§€ì—°í•˜ëŠ” ì—­í™œì„ í•©ë‹ˆë‹¤. `delayInSeconds`ì— ì •ì˜ëœ ê²ƒì— ë”°ë¼ ì§€ì—° ì´í›„ ë³´ì—¬ì§ˆ ìš”ì†Œë“¤ì„ ì„ íƒí•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤. 

> Note: Rxì—ì„œ observableì— ëŒ€í•´ `cold` ë˜ëŠ” `hot`ì´ë¼ê³  ëª…ëª…í•©ë‹ˆë‹¤. `cold` observableë“¤ì€ ìš”ì†Œë“¤ì„ êµ¬ë…í• ë•Œ ë°©ì¶œì„ ì‹œì‘í•©ë‹ˆë‹¤. `hot` observableë“¤ì€ ì–´ë–¤ ì‹œì ì—ì„œë¶€í„° ì˜êµ¬ì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤(Notifcation ê°™ì€) êµ¬ë…ì„ ì§€ì—° ì‹œì¼°ì„ë•Œ, `cold`ë¼ë©´ ì§€ì—°ì— ë”°ë¥¸ ì°¨ì´ê°€ ì—†ì§€ë§Œ. `hot` observableì´ë¼ë©´ ì¼ì • ìš”ì†Œë¥¼ ê±´ë„ˆë›°ê²Œ ë©ë‹ˆë‹¤. 
> 
> ì •ë¦¬í•˜ë©´ `cold`observableì€ ìš”ì†Œë“¤ì„ êµ¬ë…í• ë•Œë§Œ ì´ë²¤íŠ¸ë¥¼ ë°©ì¶œí•˜ì§€ë§Œ, `hot` observableì€ êµ¬ë…ê³¼ ê´€ê³„ì—†ì´ ì´ë²¤íŠ¸ë¥¼ ë°©ì¶œí•œë‹¤ëŠ” ì ì„ ê¸°ì–µí•˜ì„¸ìš”

---

#### - Delayed elements 

RxSwiftì—ì„œ ë˜ ë‹¤ë¥¸ ì¢…ë¥˜ì˜ delayëŠ” ì „ì²´ sequenceë¥¼ ë’¤ë¡œ ë¯¸ë£¨ëŠ” ì‘ìš©ì„ í•©ë‹ˆë‹¤. êµ¬ë…ì„ ì§€ì—°ì‹œí‚¤ëŠ” ëŒ€ì‹  source observableì„ ì¦‰ì‹œ êµ¬ë… í•©ë‹ˆë‹¤. ë‹¤ë§Œ ìš”ì†Œì˜ ë°©ì¶œì„ ì„¤ì •í•œ ì‹œê°„ë§Œí¼ ë¯¸ë£¬ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. 

ìƒë‹¨ì˜ `delaySubscription(_:scheduler:)` ëŒ€ì‹  ì•„ë˜ì˜ ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

```swift
 _ = sourceObservable
     .delay(RxTimeInterval(delayInSeconds), scheduler: MainScheduler.instance)
     .subscribe(delayedTimeline)
```

<center><img src="/img/posts/Time-based-4.png" width="500" height="300"></center> <br> 

ì´ì „ì˜ ì˜ˆì—ì„œ êµ¬ë…ì€ ì§€ì—°í•˜ë©´(ê¸°ë³¸ì„¤ì •ìœ¼ë¡œ) source observableí•­ëª©ì˜ ì²˜ìŒ ë‘ìš”ì†Œê°€ ëˆ„ë½ ë˜ì—ˆìŠµë‹ˆë‹¤. delay(_:scheduler:) operatorë¥¼ ì‚¬ìš©í•˜ë©´ sequence ë¥¼ time-shift í•˜ê³ ë„ ì•„ë¬´ê²ƒë„ ë†“ì¹˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 

ë‹¨ìˆœíˆ ì§€ì—°ëœ í•­ëª©ì„ `ë³¼ìˆ˜` ìˆìŠµë‹ˆë‹¤. 

---

### Timer operators

ì–´ë–¤ application dlems `timer`ë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. iOSì™€ macOSì—ëŠ” ì´ì— ëŒ€í•œ ë‹¤ì–‘í•œ ì†”ë£¨ì…˜ë“¤ì´ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ `NSTimer`ê°€ í•´ë‹¹ ì‘ì—…ì„ ìˆ˜í–‰ í–ˆì§€ë§Œ, í˜¼ë€ìŠ¤ëŸ¬ìš´ ì†Œìœ ê¶Œ ëª¨ë¸ì„ ê°€ì§€ê³  ìˆì–´ ì ì ˆí•œ ì‚¬ìš©ì´ ì–´ë ¤ì› ìŠµë‹ˆë‹¤. 

ì¢€ ë” ìµœê·¼ì—ëŠ” `dispatch`í”„ë ˆì„ì›Œí¬ê°€ `dispatch source`ë¥¼ í†µí•´ íƒ€ì´ë¨¸ë¥¼ ì œê³µí–ˆìŠµë‹ˆë‹¤. í™•ì‹¤íˆ `NSTimer`ë³´ë‹¤ ë‚˜ì€ ì†”ë£¨ì…˜ ì´ì§€ë§Œ, APIëŠ” ì—¬ì „íˆ ë©í•‘ ì—†ì´ëŠ” ë³µì¡í•©ë‹ˆë‹¤. 

ì´ì— RxSwiftëŠ” ê°„ë‹¨í•˜ê³  íš¨ê³¼ì ì¸ ì†”ë£¨ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤. 

---

#### - Intervals 

`DispatchSource`ë¥¼ ì´ìš©í•´ì„œ ì¼ì •ê°„ê²©ì˜ íƒ€ì´ë¨¸ë¥¼ ë§Œë“¤ì–´ë´…ë‹ˆë‹¤. ì´ê²ƒì„ `Observable.interval(_:scheduler:)`ì¸ìŠ¤í„´ìŠ¤ë¡œ ì „í™˜ë ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì •ì˜ëœ ìŠ¤ì¼€ì¤„ëŸ¬ì—ì„œ ì„ íƒëœ ê°„ê²©ìœ¼ë¡œ ì¼ì •í•˜ê²Œ ì „ì†¡ëœ `Int`ê°’ì˜ ë¬´í•œí•œ observableì„ ìƒì„±í•©ë‹ˆë‹¤(ì‚¬ì‹¤ìƒ ì¹´ìš´í„° ì…ë‹ˆë‹¤.)

`replay`ì˜ˆì œì—ì„œ `DispatchSource.timer(_:queue:)`ì„ í¬í•¨í•˜ëŠ” ëª¨ë“  ë¶€ë¶„ì„ ì•„ë˜ì˜ ì½”ë“œë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.

```swift
let sourceObservable = Observable<Int>
  .interval(RxTimeInterval(1.0 / Double(elementsPerSecond)), scheduler:
MainScheduler.instance)
  .replay(replayedElements)
```

<center><img src="/img/posts/Time-based-5.png" width="500" height="300"></center> <br> 

RxSwift ì—ì„œ interval timerë“¤ì„ ìƒì„±, ì·¨ì†Œ í•˜ëŠ”ê²ƒì€ ì•„ì£¼ ì‰½ìŠµë‹ˆë‹¤. 
`Observable.interval(_:scheduler:)`ì€ observableì„ ìƒì„±í•˜ë¯€ë¡œ êµ¬ë…ì„ ì†ì‰½ê²Œ `dispose()`ë¡œ ì·¨ì†Œí• ìˆ˜ ìˆìŠµë‹ˆë‹¤. êµ¬ë…ì´ ì·¨ì†Œ ëœë‹¤ëŠ”ê²ƒì€ íƒ€ì´ë¨¸ë¥¼ ë©ˆì¶˜ë‹¤ëŠ”ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. 

observableì— ëŒ€í•œ êµ¬ë…ì´ ì‹œì‘ëœ ì´í›„ ì •ì˜ëœ ê°„ê²©ë™ì•ˆ ì²«ë²ˆì§¸ ê°’ì„ ë°©ì¶œ ì‹œí‚¬ ìˆ˜ ìˆëŠ” ì•„ì£¼ ëª…í™•í•œ ë°©ë²•ì…ë‹ˆë‹¤. ë˜í•œ íƒ€ì´ë¨¸ëŠ” ì´ ì‹œì  ì´ì „ì—ëŠ” ì ˆëŒ€ ì‹œì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. êµ¬ë…ì€ ì‹œì‘ì„ ìœ„í•œ ë°©ì•„ì‡  ì—­í• ì„ í•˜ê²Œ ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

íƒ€ì„ë¼ì¸ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´, Observable.interval(_ :scheduler:)ë¥¼ í†µí•´ ë°©ì¶œëœ ê°’ì€ 0ë¶€í„° ì‹œì‘í•œë‹¤. ë‹¤ë¥¸ ê°’ì´ í•„ìš”í•˜ë‹¤ë©´, map(_:)ì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í˜„ì—…ì—ì„œëŠ” ë³´í†µ, íƒ€ì´ë¨¸ë¥¼ í†µí•´ ê°’ì„ ë°©ì¶œí•˜ì§„ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ë§Œ ì•„ì£¼ í¸ë¦¬í•˜ê²Œ indexë¥¼ ìƒì„±í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ë©ë‹ˆë‹¤.<ì°¸ê³ ê¸€>

---

#### One-shot or repeating timers 

ì¢€ë” ê°•ë ¥í•œ íƒ€ì´ë¨¸ë¥¼ ì›í•œë‹¤ë©´ `Observable.timer(:period:scheduler:)` ì—°ì‚°ìë¥¼ ì‚¬ìš©í• ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì—°ì‚°ìëŠ” ì•ì„œ ì„¤ëª…í•œ `Observable.interval(_:scheduler:)`ì™€ ìœ ì‚¬í•˜ì§€ë§Œ ëª‡ê°€ì§€ ì°¨ì´ì ì´ ìˆìŠµë‹ˆë‹¤. 

- êµ¬ë…ê³¼ ì²«ë²ˆì§¸ ê°’ ë°©ì¶œ ì‚¬ì´ì—ì„œ `due date(ë§ˆê°ì¼)`ì„ ì„¤ì •í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë°˜ë³µê¸°ê°„ì€ `optional` ì…ë‹ˆë‹¤. ë§Œì•½ ë°˜ë³µê¸°ê°„ì„ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ íƒ€ì´ë¨¸ observableì€ í•œë²ˆë§Œ ë°©ì¶œëœë’¤ ì™„ë£Œë©ë‹ˆë‹¤. 

`delay` ì˜ˆì œë¡œ ê°€ì„œ `delay(_:scheduler:)` ì—°ì‚°ìë¥¼ ì‚¬ìš©í•œ ë¶€ë¶„ì„ ì•„ë˜ì˜ ì½”ë“œë¡œ ë°”êµ¬ì–´ ë´…ë‹ˆë‹¤

```swift
_ = Observable<Int>
  .timer(3, scheduler: MainScheduler.instance)
  .flatMap { _ in
    sourceObservable.delay(RxTimeInterval(delayInSeconds), scheduler:
MainScheduler.instance)
  }
  .subscribe(delayedTimeline)
```

ë‹¤ë¥¸ íƒ€ì´ë¨¸ë¥¼ íŠ¸ë¦¬ê±°í•˜ëŠ” íƒ€ì´ë¨¸? ì´ë ‡ê²Œ í•˜ë©´ ì–´ë–¤ ì´ì ì´ ìˆì„ê¹Œ

- ê°€ë…ì„±ì´ ì¢‹ë‹¤.(ì¢€ ë” Rx ìŠ¤ëŸ½ë‹¤) 
- êµ¬ë…ì´ disposableì„ ë¦¬í„´í•˜ê¸° ë•Œë¬¸ì—, ì²«ë²ˆì§¸, ë‘ë²ˆì§¸ íƒ€ì´ë¨¸ê°€ í•˜ë‚˜ì˜ observableê³¼ í•¨ê»˜ íŠ¸ë¦¬ê±° ë˜ê¸° ì „, ì–¸ì œë“ ì§€ ì·¨ì†Œí• ìˆ˜ ìˆë‹¤.
- `flatMap(_:)` ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œì¨, `Dispatch`ì˜ ë¹„ë™ê¸° í´ë¡œì €ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ íƒ€ì´ë¨¸ sequenceë“¤ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

---

#### - Timeout 

íŠ¹ë³„í•œ ì‹œê°„ ì œí•œì„ ì‚¬ìš©í•˜ì—¬ `time-based operators`ë¥¼ ê²€ìƒ‰í• ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì£¼ëœ ëª©ì ì€ ì‹¤ã…ˆ íƒ€ì´ë¨¸ì™€ ì‹œê°„ ì´ˆê³¼(ì˜¤ë¥˜)ì¡°ê±´ì„ ì˜ë¯¸ë¡ ì ìœ¼ë¡œ êµ¬ë³„ í•˜ëŠ”ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‹œê°„ ì´ˆê³¼ê°€ ë°œìƒí•˜ë©´ `RxError.TimeoutError` ì˜¤ë¥˜ ì´ë²¤íŠ¸ë¥¼ ë°œìƒí•©ë‹ˆë‹¤. ì˜¤ë¥˜ë¥¼ ì°¾ì§€ ëª»í•˜ë©´ sequenceë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤.

```swift
let button = UIButton(type: .system)
 button.setTitle("Press me now!", for: .normal)
 button.sizeToFit()
 

let tapsTimeline = TimelineView<String>.make()
 
let stack = UIStackView.makeVertical([
     button,
     UILabel.make("Taps on button above"),
     tapsTimeline])
 

let _ = button
     .rx.tap
     .map { _ in "â—" }
     .timeout(5, scheduler: MainScheduler.instance)
     .subscribe(tapsTimeline)
 

let hostView = setupHostView()
hostView.addSubview(stack)
hostView
``` 

ë§Œì•½ ë²„íŠ¼ì´ 5ì´ˆ ì´ë‚´ë¡œ ëˆŒë ¸ë‹¤ë©´ ë­”ê°€ë¥¼ í”„ë¦°íŒ…í•˜ê³  5ì´ˆ ì´ë‚´ ë‹¤ì‹œ ëˆŒë ¤ì§€ì§€ ì•Šìœ¼ë©´ sequenceë¥¼ ì™„ì „íˆ ì¢…ë£Œí•©ë‹ˆë‹¤. ë²„íŠ¼ì´ ëˆŒë¦¬ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ í”„ë¦°íŠ¸ í•©ë‹ˆë‹¤. 

`timeout(_:scheduler:)`ì˜ ë‹¤ë¥¸ ë²„ì „ì€ observableì„ ì·¨í•˜ê³  íƒ€ì„ì•„ì›ƒì´ ì‹œì‘ë˜ì—ˆì„ ë•Œ, ì—ëŸ¬ ëŒ€ì‹  ì·¨í•œ Observableì„ ë°©ì¶œí•©ë‹ˆë‹¤. ìœ„ì˜ `timeout(_:scheduler:)`ë¶€ë¶„ì„ ì•„ë˜ ì½”ë“œë¡œ ë³€ê²½í•´ë´…ë‹ˆë‹¤

```swift
.timeout(5, other: Observable.just("X"), scheduler: MainScheduler.instance)
```

ìœ„ì˜ ì½”ë“œì—ì„  ë¹¨ê°„ìƒ‰ ì—ëŸ¬ ì´ë²¤íŠ¸ë¥¼ ë°©ì¶œ í–ˆì§€ë§Œ, ì´ë²ˆì—ëŠ” ì´ˆë¡ìƒ‰ì˜ ì¼ë°˜ì ì¸ ì™„ë£Œ ì´ë²¤íŠ¸ê°€ "X"ìš”ì†Œì™€ í•¨ê»˜ ë°©ì¶œë©ë‹ˆë‹¤. 

---

## ë¶€ìˆ˜ì‘ìš© ì–µì œí•˜ê¸°(ì°¸ê³  ìë£Œ)

- window(_:scheduler) ì—°ì‚°ìì— ëŒ€í•œ ì˜ˆì œì—ì„œ, ìš°ë¦¬ëŠ” íƒ€ì„ë¼ì¸ì„ flatMap(:_) ì—°ì‚°ìì˜ í´ë¡œì € ë‚´ë¶€ì— ìƒì„±í–ˆë‹¤.
 
- ì´ ì‘ì—…ì€ ì½”ë“œë¥¼ ê°„ëµí•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•¨ì´ì—ˆì§€ë§Œ, ë°˜ì‘í˜• í”„ë¡œê·¸ë˜ë°ì˜ ê°€ì´ë“œë¼ì¸ ì¤‘ í•˜ë‚˜ëŠ” "ë‹¨ì¼ì²´monadì—ì„œ ë²—ì–´ë‚˜ì§€ ë§ ê²ƒ" ì´ë‹¤. ë‹¤ì‹œ ë§í•˜ë©´ ë¶€ìˆ˜ì‘ìš©ì„ ìµœëŒ€í•œ ë‚´ì§€ ë§ë¼ëŠ” ê²ƒì´ë‹¤.

- ì—¬ê¸°ì„œì˜ ë¶€ì‘ìš©ì€ ë³€í˜•ë§Œ ë°œìƒí•´ì•¼í•˜ëŠ” ì‹œì ì— ìƒˆ íƒ€ì„ë¼ì¸ë„ ìƒì„±ë˜ëŠ” ê²ƒì´ë‹¤.

- ë”°ë¼ì„œ ê¸°ì¡´ì— ì‘ì„±í•œ ì½”ë“œ ëŒ€ì‹ ì— ë‹¤ë¥¸ ë°©ë²•ì„ ì°¾ëŠ” ê²ƒì´ ì´ë²ˆ ê³¼ì œë‹¤. ë¬¼ë¡  ë‹¤ì–‘í•œ ë°©ë²•ì´ ìˆì„ ìˆ˜ ìˆì§€ë§Œ, ê°€ì¥ íš¨ê³¼ì ì¸ ë°©ë²•ì€, ì‘ì—…ì„ ì—¬ëŸ¬ê°œì˜ observableë¡œ ë‚˜ëˆ„ê³ , ì¶”í›„ì— ì´ë“¤ì„ í•©ì¹˜ëŠ” ë°©ë²•ì¼ ê²ƒì´ë‹¤.
	- windowed observableë“¤ì„ í•˜ë‚˜ì”© ë‚˜ëˆ„ëŠ” ë°©ë²•ì€ íƒ€ì„ë¼ì¸ ë·°ë¥¼ ì¤€ë¹„í•˜ê³  (do(onNext:) ì—°ì‚°ìë¥¼ í†µí•´ ë¶€ì‘ìš©ì´ ë°œìƒí•  ìˆ˜ ìˆìŒì„ ì¸ì§€í•  ê²ƒ),
ìƒì„±ëœ íƒ€ì„ë¼ì¸ ë·°ì™€ source sequenceì˜ ìš”ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬, (íŒíŠ¸. zipê³¼ flatMapì„ ì¡°í•©í•´ë³¼ ê²ƒ)
	- windowê°€ ìƒˆë¡œìš´ sequenceë¥¼ ë‚´ë³´ë‚¼ ë•Œë§ˆë‹¤ ìƒí™©ì— ë”°ë¥¸ ê°’ (íƒ€ì„ë¼ì¸ ë·°ì™€ sequence)ë¥¼ ìƒì„±í•œë‹¤

```swift
let windowedObservable = sourceObservable
    .window(timeSpan: windowTimeSpan, count: windowMaxCount, scheduler: MainScheduler.instance)

let timelineObservable = windowedObservable
    .do(onNext: { _ in
        let timeline = TimelineView<Int>.make()
        stack.insert(timeline, at: 4)
        stack.keep(atMost: 8)
    })
    .map { _ in
        stack.arrangedSubviews[4] as! TimelineView<Int>
}

_ = Observable
    .zip(windowedObservable, timelineObservable) { obs, timeline in
        (obs, timeline)
    }
    .flatMap { tuple -> Observable<(TimelineView<Int>, String?)> in
        let obs = tuple.0
        let timeline = tuple.1
        return obs
            .map { value in (timeline, value) }
            .concat(Observable.just((timeline, nil)))
    }
```

- ê¸°ì¡´ windowê°€ ë¶€ìˆ˜ì‘ìš©ì„ ë‚´ëŠ”ì§€ í™•ì¸í•˜ê¸° ì–´ë µê¸° ë•Œë¬¸ì— do(onNext:)ë¥¼ í†µí•´ ìŠ¤íƒë·°ì— ì˜í–¥ì„ ì£¼ëŠ” ë†ˆë“¤ì„ í‘œì‹œí•œë‹¤.
	- ì‚¬ì‹¤ ê¸°ì¡´ ì½”ë“œëŒ€ë¡œ ì‚¬ìš©í•´ë„ í¬ê²Œ ë¬¸ì œê°€ ìƒê¸°ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. ë‹¤ë§Œ windowed observableì—ì„œ stackì˜ .insertì™€ .keepì€ .doì— ìˆëŠ”ê²Œ ë§ê³  .mapì—ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ê²ƒì´ ë§ë‹¤ê³  íŒë‹¨ë˜ëŠ” ê²ƒ.
- ëª¨ë‚˜ë“œë€?
	- ìœ„í‚¤ë¥¼ í™•ì¸í•˜ì„¸ìš”.
	- .map, .flatten, .flatMapì„ ìµœì†Œì¡°ê±´ìœ¼ë¡œ í•´ì„œ ì ìš© ê°€ëŠ¥í•œ ëª¨ë“  Genericë“¤
	- ì˜ˆ) array, optional ë“±

---

## Reference 


* ê³µì‹ 

[http://reactivex.io](http://reactivex.io/documentation/ko/observable.html) <br> 
[Introduce to Rx](http://www.introtorx.com/Content/v1.0.10621.0/00_Foreword.html) <br>
[RxJS Marbles](http://rxmarbles.com/) <br>
[RxSwift github](https://github.com/ReactiveX/RxSwift) <br>
[http://community.rxswift.org/](http://community.rxswift.org/) <br>

* ê°œì¸ ì°¸ì¡° 

[fimuxdë‹˜ github](https://github.com/fimuxd/RxSwift/blob/master/Lectures/11_Time%20Based%20Operators/Time%20Based%20Operators.md)







